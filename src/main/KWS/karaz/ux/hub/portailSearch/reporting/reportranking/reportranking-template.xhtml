<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
#macro( xt $str )
    <span>$str.replace("&","&amp;").replace("<","&lt;").replace(">","&gt;").replace("'","&#39;")</span>
#end
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Index Rokhas</title>
<style type="text/css">

@page { 
margin-top:17mm;margin-bottom:17mm;
size:A4  landscape; 
@bottom-left{ content: "© $sdf.format($now).toString().split("/")[2] ROKHAS – Powered By Karaz"; font-size:12px; font-family:Candara; color:#3C5F8D;} 
@bottom-center { content: "Imprimé Le : $sdf.format($now)"; font-size:12px; font-family:Candara; color:#3C5F8D;} 
@bottom-right { content: "Page " counter(page) " / " counter(pages)  ; font-size:12px; font-family:Candara; color:#3C5F8D;}
} 

table {    -fs-table-paginate: paginate;}
.tg  {
  border-collapse:collapse;border-spacing:0;
  -fs-table-paginate: paginate; 
  font-family: "Trebuchet MS", Arial, Helvetica, sans-serif; font-size:15px;
  margin: auto;

}
.tg .com{
  background-color: #38A;color:white;  font-family: "Trebuchet MS", Arial, Helvetica, sans-serif;
  font-size:15px;
} 
.tg .h{
  background-color: #6a9db9;color:white;  font-family: "Trebuchet MS", Arial, Helvetica, sans-serif;
  font-size:15px;
}
 .tg .t2{
  color:#666 !important;background-color: #B4C3CB !important;  font-family: "Trebuchet MS", Arial, Helvetica, sans-serif; font-size:15px;

}

.tg td{border: 1px solid #ddd;font-size:15px;
  overflow:hidden;padding:10px 5px;word-break:normal;text-align: center;}
.tg th{border:1px solid #ddd;font-size:15px;
  overflow:hidden;padding:10px 5px;word-break:normal;text-align: center;}

.tg .tg-0lax{text-align:center;vertical-align:top}
.tg tr:nth-child(even){background-color: #f2f2f2;}


</style>
</head>
 
<body>
    #set($xml=$dt.get("data"))

<div style="width:90%;height:80px;margin:auto;display:grid;grid-template-columns:40% 60%;position:relative">
<img style="width:30%;position:absolute;top:0;left:0" src="$resource-entete-page_PNG" /> 
	<div style="position:absolute;top:0;left:35%;height:33px;border-left:1px solid #eee;padding:15px 35px;font-size: 19px;text-align: left;width:80%;display:inline">
        INDEX ROKHAS <span class="rokhas-file"></span>
	</div>
	
 </div>
 <div style="text-align:center;font-size: 19px;width:90%;text-transform: uppercase;height:80px;margin:auto;text-aglin:center;margin-bottom:-15px;">
   <span>Classement de $xml.getValue("dataReportRk.trim")</span>
 </div>
 <div>

    <table class="tg">
      #foreach($ch in $xml.getElements("dataReportRk.data"))
      #if($xml.getValue("dataReportRk.type")=="commune")
      #set($str = $xml.getValue($ch,"commune").substring(0, 1).toUpperCase() + $xml.getValue($ch,"commune").substring(1).toLowerCase())
      #end
      #if($xml.getValue("dataReportRk.type")=="ville")
      #set($str = $xml.getValue($ch,"ville").substring(0, 1).toUpperCase() + $xml.getValue($ch,"ville").substring(1).toLowerCase())
      #end   
      #if($xml.getValue("dataReportRk.type")=="prefecture")
      #set($str = $xml.getValue($ch,"prefecture").substring(0, 1).toUpperCase() + $xml.getValue($ch,"prefecture").substring(1).toLowerCase())
      #end 
      #if($xml.getValue("dataReportRk.type")=="region")
      #set($str = $xml.getValue($ch,"région").substring(0, 1).toUpperCase() + $xml.getValue($ch,"région").substring(1).toLowerCase())
      #end  
                #set($gpv=($xml.getDouble($ch,"indecators.delaiGpV")))
                #set($ppv=($xml.getDouble($ch,"indecators.delaiPpV")))
                #set($ph=($xml.getDouble($ch,"indecators.delaiPhV")))
                #set($dml=($xml.getDouble($ch,"indecators.delaiDemV")))
                #set($rcp=($xml.getDouble($ch,"indecators.delaiRecV")))
                #set($rfc=($xml.getDouble($ch,"indecators.delaiRefV")))
                #set($ec=($xml.getDouble($ch,"indecators.delaiECV")))
                #set($sd=($xml.getDouble($ch,"indecators.delaiSDV")))
                #set($oan=($xml.getDouble($ch,"indecators.delaiOANV")))
                #set($afp=($xml.getDouble($ch,"indecators.delaiAFPV")))
                #set($odprt=($xml.getDouble($ch,"indecators.delaiODPRTV")))
                #set($odptu=($xml.getDouble($ch,"indecators.delaiODPTUV")))
                
                #set($fiscpc=($xml.getDouble($ch,"indecators.fiscpc")))
                #set($fiscph=($xml.getDouble($ch,"indecators.fiscph")))
                #set($fiscdem=($xml.getDouble($ch,"indecators.fiscdem")))
                #set($fiscrec=($xml.getDouble($ch,"indecators.fiscrec")))
                #set($fiscref=($xml.getDouble($ch,"indecators.fiscref")))
                #set($fiscec=($xml.getDouble($ch,"indecators.fiscec")))
                #set($fiscsd=($xml.getDouble($ch,"indecators.fiscsd")))
                #set($fiscoan=($xml.getDouble($ch,"indecators.fiscoan")))
                #set($fiscafp=($xml.getDouble($ch,"indecators.fiscafp")))
                #set($fiscodprt=($xml.getDouble($ch,"indecators.fiscodprt")))
                #set($fiscodptu=($xml.getDouble($ch,"indecators.fiscodptu")))

                #set($nbrdepotpc=($xml.getDouble($ch,"indecators.nbrdepotpc")))
                #set($nbrdepotph=($xml.getDouble($ch,"indecators.nbrdepotph")))
                #set($nbrdepotdem=($xml.getDouble($ch,"indecators.nbrdepotdem")))
                #set($nbrdepotrec=($xml.getDouble($ch,"indecators.nbrdepotrec")))
                #set($nbrdepotref=($xml.getDouble($ch,"indecators.nbrdepotref")))
                #set($nbrdepotec=($xml.getDouble($ch,"indecators.nbrdepotec")))
                #set($nbrdepotsd=($xml.getDouble($ch,"indecators.nbrdepotsd")))
                #set($nbrdepotoan=($xml.getDouble($ch,"indecators.nbrdepotoan")))
                #set($nbrdepotafp=($xml.getDouble($ch,"indecators.nbrdepotafp")))
                #set($nbrdepotodprt=($xml.getDouble($ch,"indecators.nbrdepotodprt")))
                #set($nbrdepotodptu=($xml.getDouble($ch,"indecators.nbrdepotodptu")))
                
                #set($digipc=($xml.getDouble($ch,"indecators.digipc")))
                #set($digiph=($xml.getDouble($ch,"indecators.digiph")))
                #set($digidem=($xml.getDouble($ch,"indecators.digidem")))
                #set($digirec=($xml.getDouble($ch,"indecators.digirec")))
                #set($digiref=($xml.getDouble($ch,"indecators.digiref")))
                #set($digiec=($xml.getDouble($ch,"indecators.digiec")))
                #set($digisd=($xml.getDouble($ch,"indecators.digisd")))
                #set($digioan=($xml.getDouble($ch,"indecators.digioan")))
                #set($digiafp=($xml.getDouble($ch,"indecators.digiafp")))
                #set($digiodprt=($xml.getDouble($ch,"indecators.digiodprt")))
                #set($digiodptu=($xml.getDouble($ch,"indecators.digiodptu")))

                #set($avisppj=($xml.getDouble($ch,"indecators.avisppj")))
                #set($avisgpj=($xml.getDouble($ch,"indecators.avisgpj")))
                #set($avisdem=($xml.getDouble($ch,"indecators.avisdem")))
                #set($avisrec=($xml.getDouble($ch,"indecators.avisrec")))
                #set($avisec=($xml.getDouble($ch,"indecators.avisec")))
                #set($avisoan=($xml.getDouble($ch,"indecators.avisoan")))
                #set($avisafp=($xml.getDouble($ch,"indecators.avisafp")))
                #set($avisodprt=($xml.getDouble($ch,"indecators.avisodprt")))
                #set($avisodptu=($xml.getDouble($ch,"indecators.avisodptu")))
           <tbody>
            <tr>
              <th class="tg-0lax com"   style="Text-align:center;">Rang</th>
                <th class="tg-0lax com"   style="Text-align:center;">Score</th>
              <th class="tg-0lax com" colspan="5"  style="Text-align:center;">Localité</th>
            </tr>
             <tr>
              <td class="tg-0pky t2">$xml.getValue($ch,"rank")</td>
              <td class="tg-0pky t2">$xml.getDouble($ch,"indecators.score")</td>
              <td class="tg-0pky t2" colspan="5" >$str</td>

            </tr>
            <tr>
              <td class="tg-0lax h" colspan="2"></td>
              <td class="tg-0lax h" >Délai (j)</td>
              <td class="tg-0lax h" >Attractivité (Nombre de dépôt)</td>
              <td class="tg-0lax h" >Digital</td>
              <td class="tg-0lax h" >Ecosystem (j)</td>
              <td class="tg-0lax h">Fiscalité (DH)</td>
            </tr>
            <tr>
              <td class="tg-0lax h" colspan="2" >Permis de Construire</td>
              #if($ppv.intValue()>-1 && $gpv.intValue()>-1)
              <td class="tg-0lax td2" >PPJ : $ppv.intValue() - GPJ $gpv.intValue()</td>
              #end
              #if($ppv.intValue()>-1 && $gpv.intValue()==-1)
              <td class="tg-0lax td2" >PPJ : $ppv.intValue()</td>
              #end 
               #if($ppv.intValue()==-1 && $gpv.intValue()>-1)
              <td class="tg-0lax td2" >GPJ $gpv.intValue()</td>
              #end 
              #if($ppv.intValue()==-1 && $gpv.intValue()==-1)
              <td class="tg-0lax td2" >-</td>
              #end 
              #if($nbrdepotpc.intValue()>0)
              <td class="tg-0lax td2" >$nbrdepotpc.intValue()</td>
              #else
              <td class="tg-0lax td2" >-</td>
                #end

               #if($digipc.intValue()>0)
              
              <td class="tg-0lax td2" >$digipc.intValue()</td>
              #else
                <td class="tg-0lax td2" >-</td>
                #end
              #if($avisppj.intValue()>-1 && $avisgpj.intValue()>-1)
              <td class="tg-0lax td2" >PPJ : $avisppj - GPJ $avisgpj.intValue()</td>
              #end
              #if($avisppj.intValue()>-1 && $avisgpj.intValue()==-1)
              <td class="tg-0lax td2" >PPJ : $avisppj.intValue()</td>
              #end 
               #if($avisppj.intValue()==-1 && $avisgpj.intValue()>-1)
              <td class="tg-0lax td2" >GPJ $avisgpj.intValue()</td>
              #end 
              #if($avisppj.intValue()==-1 && $avisgpj.intValue()==-1)
              <td class="tg-0lax td2" >-</td>
              #end 
              #if($fiscpc.intValue()>-1)
              <td class="tg-0lax td2" >$fiscpc.intValue()</td>       
                 #else
                <td class="tg-0lax td2" >-</td>
                #end
            </tr>
            <tr>
              <td class="tg-0lax h" colspan="2" >Permis d'habiter</td>
               #if($ph.intValue()>-1)
              
              <td class="tg-0lax td2" >$ph.intValue()</td>
                #else
                <td class="tg-0lax td2" >-</td>
                #end
                #if($nbrdepotph.intValue()>0)
              <td class="tg-0lax td2" >$nbrdepotph.intValue()</td>
                #else
                <td class="tg-0lax td2" >-</td>
                #end
                #if($digiph.intValue()>0)
              <td class="tg-0lax td2" >$digiph.intValue()</td>
                #else
                <td class="tg-0lax td2" >-</td>
                #end
                <td class="tg-0lax td2" >-</td>
                #if($fiscph.intValue()>-1)
              <td class="tg-0lax td2" >$fiscph.intValue()</td>      
                #else
                <td class="tg-0lax td2" >-</td>  
                #end
            </tr>
            <tr>
              <td class="tg-0lax h" colspan="2" >Autorisation de démolition</td>
              #if($dml.intValue()>-1)
              <td class="tg-0lax td2" >$dml.intValue()</td>
               #else
                <td class="tg-0lax td2" >-</td>
                #end
                #if($nbrdepotdem.intValue()>0)
              <td class="tg-0lax td2" >$nbrdepotdem.intValue()</td>
               #else
                <td class="tg-0lax td2" >-</td>
                #end
                #if($digidem.intValue()>0)
              <td class="tg-0lax td2" >$digidem.intValue()</td>
               #else
                <td class="tg-0lax td2" >-</td>
                #end
                #if($avisdem.intValue()>-1)
              <td class="tg-0lax td2" >$avisdem.intValue()</td>
               #else
                <td class="tg-0lax td2" >-</td>
                #end
                #if($fiscdem.intValue()>-1)
              <td class="tg-0lax td2" >$fiscdem.intValue()</td>  
               #else
                <td class="tg-0lax td2" >-</td>   
                #end   
            </tr>
             <tr>
              <td class="tg-0lax h" colspan="2" >Permis de Réception</td>
              #if($rcp.intValue()>-1)
              <td class="tg-0lax td2" >$rcp.intValue()</td>
              #else
                <td class="tg-0lax td2" >-</td>  
                #end
                #if($nbrdepotrec.intValue()>0)   
              <td class="tg-0lax td2" >$nbrdepotrec.intValue()</td>
              #else
                <td class="tg-0lax td2" >-</td>  
                #end   
                #if($digirec.intValue()>0)
              <td class="tg-0lax td2" >$digirec.intValue()</td>
              #else
                <td class="tg-0lax td2" >-</td> 
                #end    
             #if($avisrec.intValue()>-1)
              <td class="tg-0lax td2" >$avisrec.intValue()</td>
              #else
                <td class="tg-0lax td2" >-</td> 
                #end 
                #if($fiscrec.intValue()>-1)   
              <td class="tg-0lax td2" >$fiscrec.intValue()</td>  
              #else
                <td class="tg-0lax td2" >-</td>  
                #end         
            </tr>
              <tr>
              <td class="tg-0lax h" colspan="2" >Permis de Réfection</td>
               #if($rfc.intValue()>-1)
              <td class="tg-0lax td2" >$rfc.intValue()</td>
              #else
                <td class="tg-0lax td2" >-</td>    
                #end
                 #if($nbrdepotref.intValue()>0)
              <td class="tg-0lax td2" >$nbrdepotref.intValue()</td>
              #else
                <td class="tg-0lax td2" >-</td>  
                #end  
               #if($digiref.intValue()>0)
              <td class="tg-0lax td2" >$digiref.intValue()</td>
                   #else
                <td class="tg-0lax td2" >-</td>  
                #end
              <td class="tg-0lax td2" >-</td>
              #if($fiscref.intValue()>-1)
              <td class="tg-0lax td2" >$fiscref.intValue()</td>     
                   #else
                <td class="tg-0lax td2" >-</td> 
                #end    
            </tr>
               <tr>
              <td class="tg-0lax h" colspan="2" >Activité Non Réglementé </td>
              #if($ec.intValue()>-1)
              <td class="tg-0lax td2" >$ec.intValue()</td>
              #else
                <td class="tg-0lax td2" >-</td> 
                #end   
                #if($nbrdepotec.intValue()>0) 
              <td class="tg-0lax td2" >$nbrdepotec.intValue()</td>
              #else
                <td class="tg-0lax td2" >-</td> 
                #end    
                #if($digiec.intValue()>0)

              <td class="tg-0lax td2" >$digiec.intValue()</td>
              #else
                <td class="tg-0lax td2" >-</td> 
                #end 
                #if($avisec.intValue()>-1)
   
              <td class="tg-0lax td2" >$avisec.intValue()</td>
              #else
                <td class="tg-0lax td2" >-</td> 
                #end 
                #if($fiscec.intValue()>-1)
   
              <td class="tg-0lax td2" >$fiscec.intValue()</td> 
              #else
                <td class="tg-0lax td2" >-</td> 
                #end           
            </tr>
              <tr>
              <td class="tg-0lax h" colspan="2" >Simple Déclaration </td>
              #if($sd.intValue()>-1)
              <td class="tg-0lax td2" >$sd.intValue()</td>
              #else
                <td class="tg-0lax td2" >-</td> 
                #end 
                #if($nbrdepotsd.intValue()>0)
              <td class="tg-0lax td2" >$nbrdepotsd.intValue()</td>
              #else
                <td class="tg-0lax td2" >-</td> 
                #end 
                #if($digisd.intValue()>0)

              <td class="tg-0lax td2" >$digisd.intValue()</td>
              #else
                <td class="tg-0lax td2" >-</td> 
                #end 

              <td class="tg-0lax td2" >-</td>
              #if($fiscsd.intValue()>-1)

              <td class="tg-0lax td2" >$fiscsd.intValue()</td>  
              #else
                <td class="tg-0lax td2" >-</td> 
                #end       
            </tr>
              <tr>
              <td class="tg-0lax h" colspan="2" >ODP activité normale</td>
              #if($oan.intValue()>-1)

              <td class="tg-0lax td2" >$oan.intValue()</td>
              #else
                <td class="tg-0lax td2" >-</td> 
                #end    
                #if($nbrdepotoan.intValue()>0)

              <td class="tg-0lax td2" >$nbrdepotoan.intValue()</td>
              #else
                <td class="tg-0lax td2" >-</td> 
                #end    
                #if($digioan.intValue()>0)

              <td class="tg-0lax td2" >$digioan.intValue()</td>
              #else
                <td class="tg-0lax td2" >-</td> 
                #end    
                #if($avisoan.intValue()>-1)

              <td class="tg-0lax td2" >$avisoan.intValue()</td>
              #else
                <td class="tg-0lax td2" >-</td> 
                #end    
                #if($fiscoan.intValue()>-1)

              <td class="tg-0lax td2" >$fiscoan.intValue()</td>  
              #else
                <td class="tg-0lax td2" >-</td> 
                #end          
            </tr>
                <tr>
              <td class="tg-0lax h" colspan="2" >Affichage publicitaire </td>
              #if($afp.intValue()>-1)
             
              <td class="tg-0lax td2" >$afp.intValue()</td>
              #else
                <td class="tg-0lax td2" >-</td> 
                #end    

                #if($nbrdepotafp.intValue()>0)
              <td class="tg-0lax td2" >$nbrdepotafp.intValue()</td>
              #else
                <td class="tg-0lax td2" >-</td> 
                #end 
                #if($digiafp.intValue()>0)

              <td class="tg-0lax td2" >$digiafp.intValue()</td>
              #else
                <td class="tg-0lax td2" >-</td> 
                #end  
                #if($avisafp.intValue()>-1)  
              <td class="tg-0lax td2" >$avisafp.intValue()</td>
              #else
                <td class="tg-0lax td2" >-</td> 
                #end   
                #if($fiscafp.intValue()>-1) 
              <td class="tg-0lax td2" >$fiscafp.intValue()</td>        
              #else
                <td class="tg-0lax td2" >-</td> 
                #end    
            </tr>
                 <tr>
              <td class="tg-0lax h" colspan="2" >ODP Régie et télécome </td>
              #if($odprt.intValue()>-1) 

              <td class="tg-0lax td2" >$odprt.intValue()</td>
              #else
                <td class="tg-0lax td2" >-</td> 
                #end 
                #if($nbrdepotodprt.intValue()>0)
              <td class="tg-0lax td2" >$nbrdepotodprt.intValue()</td>
              #else
                <td class="tg-0lax td2" >-</td> 
                #end    
                #if($digiodprt.intValue()>0)
              <td class="tg-0lax td2" >$digiodprt.intValue()</td>
              #else
                <td class="tg-0lax td2" >-</td> 
                #end    
                #if($avisodprt.intValue()>-1)
              <td class="tg-0lax td2" >$avisodprt.intValue()</td>
              #else
                <td class="tg-0lax td2" >-</td> 
                #end  
                #if($fiscodprt.intValue()>-1)  
              <td class="tg-0lax td2" >$fiscodprt.intValue()</td>   
              #else
                <td class="tg-0lax td2" >-</td> 
                #end         
            </tr>
                 <tr>
              <td class="tg-0lax h" colspan="2" >ODP Régie et télécome - urgent </td>
              #if($odptu.intValue()>-1)
              <td class="tg-0lax td2" >$odptu.intValue()</td>
              #else
                <td class="tg-0lax td2" >-</td> 
                #end  
                #if($nbrdepotodptu.intValue()>0)  
              <td class="tg-0lax td2" >$nbrdepotodptu.intValue()</td>
              #else
                <td class="tg-0lax td2" >-</td> 
                #end    
                #if($digiodptu.intValue()>0)
              <td class="tg-0lax td2" >$digiodptu.intValue()</td>
              #else
                <td class="tg-0lax td2" >-</td> 
                #end  
              <td class="tg-0lax td2" >-</td>
              #if($fiscodptu.intValue()>-1)
              <td class="tg-0lax td2" >$fiscodptu.intValue()</td>     
              #else
                <td class="tg-0lax td2" >-</td> 
                #end       
            </tr>
           
          </tbody>
          #end
            </table>
 </div>


 

</body>

</html>