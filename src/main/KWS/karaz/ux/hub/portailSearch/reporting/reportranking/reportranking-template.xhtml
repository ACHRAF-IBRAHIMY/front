<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
#macro( xt $str )
    <span>$str.replace("&","&amp;").replace("<","&lt;").replace(">","&gt;").replace("'","&#39;")</span>
#end
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Index Rokhas</title>
<style type="text/css">

@page { 
margin-top:17mm;margin-bottom:17mm;
size:A4 rotate; 
@bottom-left{ content: "© $sdf.format($now).toString().split("/")[2] ROKHAS – Powered By Karaz"; font-size:12px; font-family:Candara; color:#3C5F8D;} 
@bottom-center { content: "Imprimé Le : $sdf.format($now)"; font-size:12px; font-family:Candara; color:#3C5F8D;} 
@bottom-right { content: "Page " counter(page) " / " counter(pages)  ; font-size:12px; font-family:Candara; color:#3C5F8D;}
} 

table {    -fs-table-paginate: paginate;}
tr{ page-break-inside:avoid;}

.table5 {
    width: 100%;
    margin: auto;
    margin-top: 35px;
}

.table5 td {
    padding-right: 2mm;
    height: 15px;
    font-size: 10px !important;
    font-family: Candara;
    text-align: left;
    margin: 0;
}

.table5 th {
    text-align: left;
    padding-left:180px;	
    height: 15px;
    font-size: 15px;
    font-family: Candara;
}

.table5 td, th {
  border: 1px solid #eee;
  padding: 8px;
}

.table5 tr:nth-child(even) {
  background-color: #eee;
}

span.mem{
    border: 1px solid #000;
    border-radius: 2px;
    padding: 2px 4px;
    margin: 2px;
    display: inline-block; 
}

img.icon{
    width: 19px;
}

.table4{
    width: 100%;
    font-size: 13px;
    color: #444;
    margin-top: 5px;
    height: 60px;
}

.table-div{
    width: 80%;
    font-size: 13px;
    margin: auto;
    text-align: center;
}

img.iconS{
    width: 14px;
}

.table4 td{
    position: relative;
}

.table3{
    border-collapse: collapse;
    border-spacing: 0;
    margin: auto;
}

.table3 td{
    margin: 0;
}

.table4 img{
    vertical-align: bottom;
    margin-right: 3px;
    position: absolute;
    top: 0;
    left: 22px;
}

.table4 span{
    position: absolute;
    top: 4px;
    left: 40px;
}

.table3{
  font-family: "Trebuchet MS", Arial, Helvetica, sans-serif;
  border-collapse: collapse;
  width: 100%;
}

.table3 td, .table3 th {
  border: 1px solid #ddd;
  padding: 8px;
  text-align:center;
  font-size:14px;
}

.table3 tr:nth-child(even){background-color: #f2f2f2;}


.table3 th {
  padding-top: 12px;
  padding-bottom: 12px;
  text-align: left;
  background-color: #38A;
  color: white;
}

</style>
</head>
 
<body>
    #set($xml=$dt.get("data"))

<div style="width:90%;height:80px;margin:auto;display:grid;grid-template-columns:40% 60%;position:relative">
<img style="width:30%;position:absolute;top:0;left:0" src="$resource-entete-page_PNG" /> 
	<div style="position:absolute;top:0;left:35%;height:33px;border-left:1px solid #eee;padding:15px 35px;font-size: 19px;text-align: left;width:80%;display:inline">
        INDEX ROKHAS <span class="rokhas-file"></span>
	</div>
	
 </div>
 <div style="text-align:center;font-size: 19px;width:90%;text-transform: uppercase;height:80px;margin:auto;text-aglin:center;margin-bottom:-15px;">
   <span>Classement de $xml.getValue("dataReportRk.trim")</span>
 </div>
 <div>

    <table class="table3">
    
        <tr>
            <th style="font-size: 10px !important;text-align:center;" rowspan="2">Commune</th>
            <th style="font-size: 10px !important;text-align:center;" rowspan="2">Rang</th>
            <th style="font-size: 10px !important;text-align:center;" rowspan="2">Score</th>
            <th style="font-size: 10px !important;text-align:center;" colspan="12">Délai</th>
            <th style="font-size: 10px !important;text-align:center;" colspan="2">Attractivité</th>
            <th style="font-size: 10px !important;text-align:center;" rowspan="2">Digital</th>
            <th style="font-size: 10px !important;text-align:center;" rowspan="2">Ecosystème</th>
            <th style="font-size: 10px !important;text-align:center;" colspan="2">Fiscalité</th>
        </tr>
        <tr>
            <th style="font-size: 10px !important;text-align:center;color:#666;background: #EEE;">Score</th>
            <th style="font-size: 10px !important;text-align:center;color:#666;background: #EEE;width: 150px !important;">Délai Gpj (jr)</th>
            <th style="font-size: 10px !important;text-align:center;color:#666;background: #EEE;width: 150px !important;">Délai Ppj (jr)</th>
            <th style="font-size: 10px !important;text-align:center;color:#666;background: #EEE;width: 150px !important;">Délai Ph (jr)</th>
            <th style="font-size: 10px !important;text-align:center;color:#666;background: #EEE;width: 150px !important;">Délai Dml (jr)</th>
            <th style="font-size: 10px !important;text-align:center;color:#666;background: #EEE;width: 150px !important;">Délai Rcp (jr)</th>
            <th style="font-size: 10px !important;text-align:center;color:#666;background: #EEE;width: 150px !important;">Délai Rfc (jr)</th>
            <th style="font-size: 10px !important;text-align:center;color:#666;background: #EEE;width: 150px !important;">Délai Ec (jr)</th>
            <th style="font-size: 10px !important;text-align:center;color:#666;background: #EEE;width: 150px !important;">Délai Sd (jr)</th>
            <th style="font-size: 10px !important;text-align:center;color:#666;background: #EEE;width: 150px !important;">Délai Oan (jr)</th>
            <th style="font-size: 10px !important;text-align:center;color:#666;background: #EEE;width: 150px !important;">Délai Afp (jr)</th>
            <th style="font-size: 10px !important;text-align:center;color:#666;background: #EEE;width: 150px !important;">Délai Odprt (jr)</th>
            <th style="font-size: 10px !important;text-align:center;color:#666;background: #EEE;width: 150px !important;">Délai Odptu (jr)</th>
            <th style="font-size: 10px !important;text-align:center;color:#666;background: #EEE;">Score</th>
            <th style="font-size: 10px !important;text-align:center;color:#666;background: #EEE;">Nombre dossiers</th>
            <th style="font-size: 10px !important;text-align:center;color:#666;background: #EEE;">Score</th>
            <th style="font-size: 10px !important;text-align:center;color:#666;background: #EEE;">Fiscalité Dhs/m²</th>
        </tr>
        #foreach($ch in $xml.getElements("dataReportRk.data"))
            <tr>
                #set($str = $xml.getValue($ch,"commune").substring(0, 1).toUpperCase() + $xml.getValue($ch,"commune").substring(1).toLowerCase())
                #set($fiscalite=(($xml.getDouble($ch,"indecators.fiscaliteUV"))))
                #set($gpv=($xml.getDouble($ch,"indecators.delaiGpV")))
                #set($ppv=($xml.getDouble($ch,"indecators.delaiPpV")))
                #set($ph=($xml.getDouble($ch,"indecators.delaiPhV")))
                #set($dml=($xml.getDouble($ch,"indecators.delaiDemV")))
                #set($rcp=($xml.getDouble($ch,"indecators.delaiRecV")))
                #set($rfc=($xml.getDouble($ch,"indecators.delaiRefV")))
                #set($ec=($xml.getDouble($ch,"indecators.delaiECV")))
                #set($sd=($xml.getDouble($ch,"indecators.delaiSDV")))
                #set($oan=($xml.getDouble($ch,"indecators.delaiOANV")))
                #set($afp=($xml.getDouble($ch,"indecators.delaiAFPV")))
                #set($odprt=($xml.getDouble($ch,"indecators.delaiODPRT")))
                #set($odptu=($xml.getDouble($ch,"indecators.delaiODPTU")))

                <td style="font-size: 10px !important;text-align:left;" >$str</td>
                <td style="font-size: 10px !important;" >$xml.getValue($ch,"rank")</td>
                <td style="font-size: 10px !important;" >$xml.getDouble($ch,"indecators.score").intValue()</td>
                <td style="font-size: 10px !important;" >$xml.getDouble($ch,"indecators.delai").intValue()</td>
                #if($ppv.intValue()>-1)
                <td style="font-size: 10px !important;width: 250px !important;" width="10%">$ppv.intValue()</td>

                #else
                <td style="font-size: 10px !important;width: 250px !important;" width="10%">-</td>

                #end
                  #if($gpv.intValue()>-1)
                <td style="font-size: 10px !important;width: 250px !important;" width="10%">$gpv.intValue()</td>

                #else
                <td style="font-size: 10px !important;width: 250px !important;" width="10%">-</td>

                #end
                  #if($ph.intValue()>-1)
                <td style="font-size: 10px !important;width: 250px !important;" width="10%">$ph.intValue()</td>

                #else
                <td style="font-size: 10px !important;width: 250px !important;" width="10%">-</td>

                #end  
                #if($dml.intValue()>-1)
                <td style="font-size: 10px !important;width: 250px !important;" width="10%">$dml.intValue()</td>

                #else
                <td style="font-size: 10px !important;width: 250px !important;" width="10%">-</td>

                #end  #if($rcp.intValue()>-1)
                <td style="font-size: 10px !important;width: 250px !important;" width="10%">$rcp.intValue()</td>

                #else
                <td style="font-size: 10px !important;width: 250px !important;" width="10%">-</td>

                #end  #if($rfc.intValue()>-1)
                <td style="font-size: 10px !important;width: 250px !important;" width="10%">$rfc.intValue()</td>

                #else
                <td style="font-size: 10px !important;width: 250px !important;" width="10%">-</td>

                #end  #if($ec.intValue()>-1)
                <td style="font-size: 10px !important;width: 250px !important;" width="10%">$ec.intValue()</td>

                #else
                <td style="font-size: 10px !important;width: 250px !important;" width="10%">-</td>

                #end  #if($sd.intValue()>-1)
                <td style="font-size: 10px !important;width: 250px !important;" width="10%">$sd.intValue()</td>

                #else
                <td style="font-size: 10px !important;width: 250px !important;" width="10%">-</td>

                #end  #if($oan.intValue()>-1)
                <td style="font-size: 10px !important;width: 250px !important;" width="10%">$oan.intValue()</td>

                #else
                <td style="font-size: 10px !important;width: 250px !important;" width="10%">-</td>

                #end
                 #if($odprt.intValue()>-1)
                <td style="font-size: 10px !important;width: 250px !important;" width="10%">$odprt.intValue()</td>

                #else
                <td style="font-size: 10px !important;width: 250px !important;" width="10%">-</td>

                #end
                  #if($odptu.intValue()>-1)
                <td style="font-size: 10px !important;width: 250px !important;" width="10%">$odptu.intValue()</td>

                #else
                <td style="font-size: 10px !important;width: 250px !important;" width="10%">-</td>

                #end
                <td style="font-size: 10px !important;width: 250px !important;" width="10%">$gpv.intValue()</td>
                <td style="font-size: 10px !important;" >$xml.getDouble($ch,"indecators.attractivite").intValue()</td>
                <td style="font-size: 10px !important;" >$xml.getDouble($ch,"indecators.attractiviteUV").intValue()</td>
                <td style="font-size: 10px !important;" >$xml.getDouble($ch,"indecators.digital").intValue()</td>
                <td style="font-size: 10px !important;" >$xml.getDouble($ch,"indecators.ecosystem").intValue()</td>
                <td style="font-size: 10px !important;" >$xml.getDouble($ch,"indecators.fiscalite").intValue()</td>
                <td style="font-size: 10px !important;" >$fiscalite.intValue()</td> 
            </tr>
        #end
            </table>
 </div>


 

</body>

</html>