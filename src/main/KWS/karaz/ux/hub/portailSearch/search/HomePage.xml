<?xml version="1.0" encoding="UTF-8"?>
<search name="HomePage" label="Home Page">
  <query />
  <data>
    <query>
      <search />
      <idObject />
      <parentP />
    </query>
    <collapsed>false</collapsed>
  </data>
  <view>
    <screen labelWidth="80" label="My Dashboard" noToolBar="true">
      <css>

        

        .body-geo-gis .geo-card{
          display: block;
          padding: 15px;
          margin: 30px 1rem;
          color: var(--fg1);
          background-color: #EEE;
          border-radius: 2px;
          box-shadow: 3px 3px 3px #0004;
          border: 1px solid #DDD;
          height: 200px;
          box-sizing: border-box;
          text-align: left;
          position:relative;        
        }

        .body-geo-gis .geo-card-gb{
          display: block;
          padding: 15px; 
          margin: 30px 1rem;
          color: var(--fg1);
          background-color: #EEE;
          border-radius: 2px;
          box-shadow: 3px 3px 3px #0004;
          border: 1px solid #DDD;
          height: 660px;
          box-sizing: border-box;
          text-align: left;
        }

        .body-geo-gis .btn-agrandir{
          color: #FFF;
          background: #666;
        }

        .body-geo-gis .btn-reduire{
          position: absolute;
          right: 0px;
          background: #333;
          color: #EEE;
          z-index: 99;
          margin-top: 0px !important;
          padding: 7.5px 19px;
          border-radius: 0;
        }

        .geoProtailBck .kma-map{
          height: 400px !important;
        }

        .fieldset-footer-home {
        
          font-weight: 100;
        
      }
      </css>
      <script postLoad="true">

        root.instanceId = context.formRender.formInstanceId;
        console.log("instanceId",root.instanceId);
        context.formRender.notifyObservers("instanceId");

        /*
        $("#home-gloAl-"+root.instanceId+" .close").click(function(e){
          var modal = $("#home-gloAl-"+root.instanceId+" #myModal").get(0);
          model.style.display="none";
        })
        */

        var toolbarOptions = [
          [ 'bold', 'italic', 'underline', 'strike' ],
          [{ 'color': [] }, { 'background': [] }],
          [{ 'header': '1' }, { 'header': '2' }],
          [{ 'list': 'ordered' }, { 'list': 'bullet'}, { 'indent': '-1' }, { 'indent': '+1' }],
          [ 'direction', { 'align': [] }],
          ['image'],
        ];

      var ddv = context.formRender.targetPanel.find("#toolbarNBNB").get(0);
      var quill = new Quill(ddv, {
        modules: {
          toolbar: toolbarOptions
        },
        theme: 'snow'
      });

    </script>
    <script postLoad="true" delay="500">
      console.log("context",context);
      
      getMostPopularArticle(4,"",".classSearch-home-gloAl .fieldser-article-1 .vbox-articles .ow-vl-inner");      
    </script>
    <css>
      .classSearch-home-gloAl .hp-box-nbnb{
            display: block;
          padding: 1rem;
        margin: 10px 1rem;
        color: var(--fg1);
        background-color: white;
        border-radius: 2px;
        box-shadow: 3px 3px 3px #0004;
        border: 1px solid #DDD;
        text-align: center;
        height: 100%;
        box-sizing: border-box;
        }

        #toolbarNBNB{
          height: 130px;
        }

        .marquenbnb p{
          display:inline;
          margin-left:5px;
        }
    </css>
    <css>
      
      /* The Modal (background) */
      .geoPortPop .modal {
        display: none; /* Hidden by default */
        position: fixed; /* Stay in place */
        z-index: 1; /* Sit on top */
        padding-top: 100px; /* Location of the box */
        left: 0;
        top: 0;
        width: 100%; /* Full width */
        height: 100%; /* Full height */
        overflow: auto; /* Enable scroll if needed */
        background-color: rgb(0,0,0); /* Fallback color */
        background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
      }
      
      /* Modal Content */
      .geoPortPop .modal-content {
        background-color: #fefefe;
        margin: auto;
        padding: 20px;
        border: 1px solid #888;
        width: 80%;
      }
      
      /* The Close Button */
      .geoPortPop .close {
        color: #aaaaaa;
        float: right;
        font-size: 28px;
        font-weight: bold;
      }
      
      .geoPortPop .close:hover,
      .geoPortPop .close:focus {
        color: #000;
        text-decoration: none;
        cursor: pointer;
      }

      .geo-card-gb.geo-grd .geoProtailBck{
        height: 570px !important;
        overflow: hidden !important;

      }
      
      .geo-card-gb.geo-grd .kma-side-right{
        height: 570px !important;
      }

      .geo-card-gb.geo-grd .esriMapContainer{
        height: 560px !important;
        overflow: hidden;
      }

      .geo-card-gb.geo-grd  .kma-homeButton-container {
        position: absolute;
        left: 22px;
        bottom: 0px;
        top: 480px;
        height: 100%;
    }

      .geo-card-gb.geo-grd .HomeButton .home {
      }
      
      .geo-card-gb.geo-grd .esriScalebar{
        left: 25px;
        height: 100%;
        top: 518px;
      }

      .geo-card-gb.geo-grd .kma-homeButton-container{
        bottom: 105px;
      }

      .geo-card-gb.geo-rdw .geoProtailBck,.geo-card-gb.geo-rdw .kma-side-right{
      }

      .geo-card-gb.geo-rdw .esriMapContainer{
      }

      .geo-card-gb.geo-rdw .HomeButton .home {
      }
      
      .geo-card-gb.geo-rdw .esriScalebar{
      }
      


      </css>
    <vbox style="background:#FFF;">
      <vbox labelAlign="float" style="background:#FFF;width:100%;height:auto;">
        
        <vbox className="body-geo-gis">
          <vbox columns="35% 65%">
            <vbox>
              <vbox className="geo-card">
                <html xpath="instanceId">
                  <div class="geoPortPop" >
                    <div style="display:grid;grid-template-columns: 110px auto;">
                      <div style="text-align:center;"><i style="width: 70px;text-align: center;font-size: 65px;height: 65px;color: #666;margin-top: 10px;line-height: 145px;" class="fab fa-youtube" /></div>
                      <div>
                          <div><span style="color: #666;font-size: 1.3vw;">Comment ça marche ?</span></div>
                          <div><span style="font-size: 0.9565vw;color: #666;">Découvrez le géoportail national de l’urbanisme en 3 mn</span></div>
                          
                          <div>
                            <p style="font-size:0.7vw;color:#666;text-align:justify;margin-top: 4px;margin-bottom: 5px;">
                              Découvrez ici le géoportail national des documents d’urbanisme. Dans cette vidéo de 3 mn vous aurez un premier aperçu sur la nature et la consistance des géo-données publiées sur le géoportail national, les fonctionnalités de navigation spatiale qu’il offre et les outils de recherche qu’il propose.
                            </p>
                          </div>
                          <div style="
                          text-align: right;
                          font-size: 1vw;    
                          color: #666;
                          cursor: pointer;
                          position: absolute;
                          right: 5px;
                          bottom: 3px;
                      ">
                          <span onclick="openGeoPopUp('home-gloAl-${instanceId}')" style="margin-right:5px"> <i class="fas fa-file"></i> Voir</span>
                          <span> <i class="fas fa-info-circle"></i> À propos </span>
                      </div>
                        </div>  
                      
                    </div>
                  
                  </div>
                </html>
              
              </vbox> 

              <html xpath="instanceId" className="geoPortPop">
                <div id="home-gloAl-${instanceId}">
                  <div id="myModal" class="modal">
                    <div class="modal-content">
                      <span class="close" onclick="closeGeoPopUp('home-gloAl-${instanceId}')">x</span>
                      <p>Video..</p>
                    </div>
                  </div>
                </div>
                
              </html>

              

              <vbox className="geo-card">
                <html>
                  <div style="display:grid;grid-template-columns: 110px auto;">
                    <div style="text-align:center;"><i style="width: 70px;text-align: center;font-size: 65px;height: 65px;color: #666;margin-top: 10px;line-height: 145px;" class="fas fa-university" /></div>
                    <div>
                      <div><span style="color: #666;font-size: 1.3vw;color: #666;">Intéressé par une localité précise ?</span></div>
                      <div><span style="font-size: 0.9565vw;color: #666;">Consultez les documents d’urbanisme par agence urbaine</span></div>
                      <div>
                        <p style="font-size:0.7vw;color:#666;text-align:justify;margin-top: 4px;margin-bottom: 5px;">
                          Le territoire national est couvert par 30 agences urbaines dont chacune pilote la production des documents d’urbanisme pour un périmètre territorial prédéfini. Si vous êtes intéressés par une localité en particulier, vous pouvez accéder ici directement aux documents d’urbanisme produits par l’agence urbaine.

                        </p>
                      </div>
                      <div style="
                      text-align: right;
                      font-size: 1vw;    
                      color: #666;
                      cursor: pointer;
                      position: absolute;
                      right: 5px;
                      bottom: 3px;
                  ">
                  <span onclickxx="openGeoPopUp('home-gloAl-${instanceId}')" style="margin-right:5px"> <i class="fas fa-file"></i> Voir</span>
                      <span> <i class="fas fa-info-circle"></i> À propos </span>
                  </div>
                    </div>
                  </div>
                </html>
              </vbox>

              <vbox className="geo-card">
                <html>
                  <div style="display:grid;grid-template-columns: 110px auto;">
                    <div style="text-align:center;"><i style="width: 70px;line-height: 145px;text-align: center;font-size: 65px;height: 65px;color: #666;margin-top: 10px;" class="fas fa-map-marked-alt" /></div>
                    <div>
                      <div>
                        <span style="color: #666;font-size: 1.3vw;color: #666;">Quelle réglementation de zone ?</span>
                      </div>
                      <div>
                        <span style="font-size: 0.9565vw;color: #666;">Prenez connaissance de la nomenclature nationale</span>
                      </div>
                      <div>
                        <p style="font-size: 0.7vw;color:#666;text-align:justify;margin-top: 4px;margin-bottom: 5px;">
                          Dans le but d’uniformiser les documents d’urbanisme publiés par les différentes agences urbaines et d’en faciliter l’exploitation par les administrations concernées, les professionnels de l’urbanisme et les citoyens, une nomenclature nationale standard a été publiée par le Ministère. Prenez-en connaissance à travers cet outil interactif.
                        </p>
                      </div>
                          <div style="
                              text-align: right;
                              font-size: 1vw;
                              color: #666;
                              cursor: pointer;
                              position: absolute;
                              right: 5px;
                              bottom: 3px;
                          ">
                          <span onclickxx="openGeoPopUp('home-gloAl-${instanceId}')" style="margin-right:5px"> <i class="fas fa-file"></i> Voir</span>  
                          <span> <i class="fas fa-info-circle"></i> À propos </span>
                          </div>
                    </div>
                  </div> 
                  
                </html>
              </vbox>
            </vbox> 
            <vbox className="geo-card-gb geo-grd">
              <vbox columns="auto 170px">
                <vbox>
                  <html>
                    <div><span style="color: #666;font-size: 20px;color: #666;">Point d’accès unique à toute la donnée urbanistique</span></div>
                    <div><span style="font-size: 14px;color: #666;">En quelques clics, accédez instantanément à l’ensemble des documents d’urbanisme de tout le Royaume !</span></div>
                  </html>
                </vbox>
                <vbox> 
                  <button icon="fas fa-expand" className="btn-agrandir" label="AGRANDIR">
                    <postChange>
                      var mapBrws = context.formRender.targetPanel.find(".geoProtailBck");
                      mapBrws.css({
                        "height": "100vh",
                        "width":"100%",
                        "position":"fixed",
                        "left":0,
                        "top":0,
                        "z-index":"99"
                      });
                      root.visiblerd = "oui";
                      context.formRender.targetPanel.find(".geo-card-gb").addClass("geo-rdw");
                      context.formRender.targetPanel.find(".geo-card-gb").removeClass("geo-grd");

                      context.formRender.notifyObservers("visiblerd");
                    </postChange>
                  </button>
                </vbox>
                <vbox>
              </vbox>
              
            </vbox> 
            <vbox height="570" style="height:450px;background:#EEE" className="geoProtailBck">
              <button icon="fas fa-expand" className="btn-reduire" visible="('{visiblerd}'=='oui'),expr,boolean" label="RÉDUIRE">
                <postChange>
                  var mapBrws = context.formRender.targetPanel.find(".geoProtailBck");
                  mapBrws.css({
                    "height": "450px",
                    "width":"auto",
                    "position":"relative",
                    "left":0,
                    "top":0,
                    "z-index":"0"
                  }); 
                  root.visiblerd = "";
                  context.formRender.targetPanel.find(".geo-card-gb").addClass("geo-grd");
                  context.formRender.targetPanel.find(".geo-card-gb").removeClass("geo-rdw");
                  context.formRender.notifyObservers("visiblerd");
                </postChange>
              </button>
              <search height="570" mapIdPath="mapIdBrowser" searchQN="dataLoader:gis/service/providers/KGisMapDataLoader?use=search&amp;fromMapBrowser=0003" />
            </vbox>
          </vbox>
        </vbox>
      </vbox>
      
      </vbox>
      <html>
        <div style="height: 20px;" />
      </html>
      <vbox className="classSearch-home-gloAl">
        <html>
          <span style="margin-left: 24px;margin-top: 14px;font-size: 21px;color: #555;">
            Derniers documents d’urbanisme publiés
          </span>
        </html>
        <html>
        </html>
        <vbox>
          <search searchQN="gis/virtual/search/AllVirtual?searchName=docUrbanismeAcc" />
          <vbox className="fieldset-footer-home">
            <html>
                <div style="text-align:right;width:99%;" class="class-traduction" tcode="APA1"><span style="background: #38A;color: #FFF;padding: 5px;border-radius: 2px;" onClick="ApplicationManager.run(&quot;karaz/ux/hub/portailsearch/search/UrbanismeSearch&quot;, &quot;search&quot;, &quot;Document d'urbanisme&quot;, {});">Tous les documents d’urbanisme</span></div>
            </html>
          </vbox>
        </vbox>
        
        <html>
          <span style="margin-left: 24px;margin-top: 14px;font-size: 21px;color: #555;">
            Dernières ressources publiées
          </span> 
        </html>
        <html>  
          <div style="height: 20px;" />
        </html>
        <vbox className="fieldset-articles fieldser-article-1" style="width: 98.5%;margin: auto;">
          <vbox className="vbox-articles" columns="25% 25% 25% 25%">
             
          </vbox>
          <vbox className="fieldset-footer-home">
              <html>
                  <div style="text-align:right;" class="class-traduction" tcode="APA1"><span style="background: #38A;color: #FFF;padding: 5px;border-radius: 2px;" onClick="ApplicationManager.run(&quot;karaz/ux/hub/portailsearch/search/ArticlesListe?query.typeArticle=0&quot;, &quot;search&quot;, &quot;Articles&quot;, {});">Toute l’actualité</span></div>
              </html>
          </vbox>
        </vbox>

      </vbox>
    </vbox>
      <html>
        <div style="height: 30px;" />
      </html>
    </screen>
  </view>
</search>
